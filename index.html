<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Madhav â€¢ Video Portal</title>
  <style>
    :root { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }
    body { margin: 0; background: #0b1220; color: #e8eefc; }
    .nav { display:flex; justify-content:space-between; align-items:center; padding:14px 18px; position:sticky; top:0; background: rgba(11,18,32,.9); backdrop-filter: blur(10px); border-bottom: 1px solid rgba(255,255,255,.08); }
    .brand { font-weight: 700; letter-spacing: .3px; }
    .btn { cursor:pointer; border:1px solid rgba(255,255,255,.14); background: rgba(255,255,255,.06); color:#e8eefc; padding:8px 12px; border-radius:12px; }
    .btn:hover { background: rgba(255,255,255,.10); }
    .wrap { max-width: 1050px; margin: 0 auto; padding: 18px; }
    .hero { display:flex; gap:16px; align-items:flex-start; flex-wrap: wrap; padding: 18px; border:1px solid rgba(255,255,255,.10); border-radius: 18px; background: rgba(255,255,255,.04); }
    .hero h1 { margin:0; font-size: 22px; }
    .hero p { margin:8px 0 0; opacity:.9; line-height: 1.45; }
    .grid { margin-top: 16px; display:grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
    @media (max-width: 980px){ .grid{ grid-template-columns: repeat(2, 1fr);} }
    @media (max-width: 520px){ .grid{ grid-template-columns: 1fr;} }
    .card { border:1px solid rgba(255,255,255,.10); border-radius: 16px; padding: 14px; background: rgba(255,255,255,.03); cursor:pointer; }
    .card:hover{ background: rgba(255,255,255,.06); }
    .muted { opacity:.75; font-size: 13px; }
    .row { display:flex; gap:10px; align-items:center; flex-wrap: wrap; margin-top: 14px; }
    input, select, textarea {
      width: 100%; box-sizing: border-box; padding: 10px 12px;
      border-radius: 12px; border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06); color: #e8eefc;
      outline: none;
    }
    textarea { min-height: 90px; resize: vertical; }
    .list { margin-top: 14px; display:grid; gap: 12px; }
    .item { border:1px solid rgba(255,255,255,.10); border-radius: 16px; padding: 14px; background: rgba(255,255,255,.03); display:flex; justify-content:space-between; gap:12px; align-items:flex-start; }
    .item h3 { margin:0 0 6px; font-size: 16px; }
    .pill { font-size: 12px; opacity:.85; padding: 4px 8px; border-radius: 999px; border: 1px solid rgba(255,255,255,.14); }
    .modalOverlay {
      position: fixed; inset: 0; background: rgba(0,0,0,.55);
      display:none; align-items:center; justify-content:center; padding: 18px;
    }
    .modal {
      width: min(520px, 100%); background: #0f1a2f;
      border: 1px solid rgba(255,255,255,.12); border-radius: 18px; padding: 16px;
      box-shadow: 0 16px 50px rgba(0,0,0,.45);
    }
    .modalHeader { display:flex; justify-content:space-between; align-items:center; gap:12px; }
    .modalHeader h2 { margin:0; font-size: 18px; }
    .close { cursor:pointer; font-size: 20px; opacity:.8; }
    .close:hover { opacity: 1; }
    .danger { color: #ffb4b4; font-size: 13px; margin-top: 8px; display:none; }
  </style>
</head>
<body>
  <div class="nav">
    <div class="brand">ðŸŽ¥ Madhav â€¢ Video Portal</div>
    <div class="row" style="margin:0">
      <button class="btn" id="adminBtn">Admin</button>
    </div>
  </div>

  <div class="wrap">
    <div class="hero">
      <div style="flex:1; min-width: 260px;">
        <h1>Hey! Iâ€™m Madhav ðŸ‘‹</h1>
        <p class="muted">
          This is my private video hub. I upload videos by category (Java, AWS, AI, Projects, etc.).
          Pick a category below to browse.
        </p>
      </div>
      <div style="min-width: 260px; flex:1;">
        <div class="row" style="margin-top:0;">
          <input id="searchInput" placeholder="Search videos (title/description)..." />
          <select id="sortSelect" style="max-width: 220px;">
            <option value="new">Newest first</option>
            <option value="old">Oldest first</option>
            <option value="az">Title A â†’ Z</option>
          </select>
        </div>
        <div class="muted" id="statusLine" style="margin-top:8px;"></div>
      </div>
    </div>

    <div class="grid" id="categoryGrid"></div>

    <div class="row">
      <div class="pill" id="activeCategoryPill">All</div>
      <button class="btn" id="clearCategoryBtn">Clear</button>
      <button class="btn" id="resetLocalBtn" title="Deletes only the videos stored in this browser">Reset local videos</button>
    </div>

    <div class="list" id="videoList"></div>
  </div>

  <!-- Login modal -->
  <div class="modalOverlay" id="loginOverlay">
    <div class="modal">
      <div class="modalHeader">
        <h2>Admin Login</h2>
        <div class="close" data-close="loginOverlay">âœ•</div>
      </div>
      <div style="margin-top:12px; display:grid; gap:10px;">
        <input id="adminUser" placeholder="Username" />
        <input id="adminPass" type="password" placeholder="Password" />
        <button class="btn" id="loginSubmit">Login</button>
        <div class="danger" id="loginError">Wrong username/password.</div>
        <div class="muted">Note: This is a static site, so this login is only basic protection.</div>
      </div>
    </div>
  </div>

  <!-- Add video modal -->
  <div class="modalOverlay" id="addOverlay">
    <div class="modal">
      <div class="modalHeader">
        <h2>Add New Video</h2>
        <div class="close" data-close="addOverlay">âœ•</div>
      </div>
      <div style="margin-top:12px; display:grid; gap:10px;">
        <input id="vLink" placeholder="YouTube link (or video id)" />
        <input id="vCategory" placeholder="Category (e.g., Java, AWS, AI)" />
        <textarea id="vDesc" placeholder="Short description"></textarea>
        <input id="vTitle" placeholder="Title (optional, else auto)"/>
        <button class="btn" id="addSubmit">Save</button>
        <div class="danger" id="addError">Please enter at least link + category.</div>
        <div class="muted">Saved into this browser (localStorage). To share across devices youâ€™ll need JSON + Git commit.</div>
      </div>
    </div>
  </div>

<script>
  // =========================
  // 1) CONFIG (change these)
  // =========================
  const ADMIN_USERNAME = "admin";          // change
  const ADMIN_PASSWORD = "1234";           // change
  const STORAGE_KEY = "madhav_video_portal_videos_v1";

  // Optional starter videos (these load first, then localStorage adds more)
  const STARTER_VIDEOS = [
    // Example:
    // { id: crypto.randomUUID(), title:"Intro to Java Streams", youtubeId:"dQw4w9WgXcQ", category:"Java", desc:"Streams basics + examples", createdAt: "2025-12-15T10:00:00Z" }
  ];

  // =========================
  // 2) Helpers
  // =========================
  function extractYouTubeId(input) {
    if (!input) return "";
    const s = input.trim();
    // If user pasted an ID directly
    if (/^[a-zA-Z0-9_-]{11}$/.test(s)) return s;

    // Try URL patterns
    const patterns = [
      /v=([a-zA-Z0-9_-]{11})/,
      /youtu\.be\/([a-zA-Z0-9_-]{11})/,
      /embed\/([a-zA-Z0-9_-]{11})/,
      /shorts\/([a-zA-Z0-9_-]{11})/
    ];
    for (const p of patterns) {
      const m = s.match(p);
      if (m && m[1]) return m[1];
    }
    return "";
  }

  function loadLocalVideos() {
    try {
      const raw = localStorage.getItem(STORAGE_KEY);
      return raw ? JSON.parse(raw) : [];
    } catch {
      return [];
    }
  }
  function saveLocalVideos(videos) {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(videos));
  }

  // Merge starter + local (local last)
  let videos = [...STARTER_VIDEOS, ...loadLocalVideos()];

  // UI state
  let activeCategory = "All";

  // =========================
  // 3) Render
  // =========================
  function getCategories() {
    const set = new Set(videos.map(v => (v.category || "").trim()).filter(Boolean));
    return ["All", ...Array.from(set).sort((a,b)=>a.localeCompare(b))];
  }

  function filteredVideos() {
    const q = document.getElementById("searchInput").value.trim().toLowerCase();
    let list = [...videos];

    if (activeCategory !== "All") {
      list = list.filter(v => (v.category || "").toLowerCase() === activeCategory.toLowerCase());
    }
    if (q) {
      list = list.filter(v =>
        (v.title || "").toLowerCase().includes(q) ||
        (v.desc || "").toLowerCase().includes(q) ||
        (v.category || "").toLowerCase().includes(q)
      );
    }

    const sort = document.getElementById("sortSelect").value;
    if (sort === "new") list.sort((a,b)=> new Date(b.createdAt) - new Date(a.createdAt));
    if (sort === "old") list.sort((a,b)=> new Date(a.createdAt) - new Date(b.createdAt));
    if (sort === "az") list.sort((a,b)=> (a.title||"").localeCompare(b.title||""));

    return list;
  }

  function renderCategories() {
    const grid = document.getElementById("categoryGrid");
    grid.innerHTML = "";
    const cats = getCategories();

    cats.filter(c => c !== "All").forEach(cat => {
      const count = videos.filter(v => (v.category||"").toLowerCase() === cat.toLowerCase()).length;
      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `
        <div style="font-weight:700; margin-bottom:6px;">${cat}</div>
        <div class="muted">${count} video${count===1?"":"s"}</div>
      `;
      div.onclick = () => { activeCategory = cat; renderAll(); };
      grid.appendChild(div);
    });

    // If no categories
    if (cats.length === 1) {
      grid.innerHTML = `<div class="muted">No videos yet. Click Admin â†’ add your first video.</div>`;
    }
  }

  function renderList() {
    const listDiv = document.getElementById("videoList");
    const pill = document.getElementById("activeCategoryPill");
    const status = document.getElementById("statusLine");

    pill.textContent = activeCategory;
    const list = filteredVideos();
    status.textContent = `${list.length} video${list.length===1?"":"s"} showing`;

    listDiv.innerHTML = "";
    list.forEach(v => {
      const el = document.createElement("div");
      el.className = "item";

      const yt = v.youtubeId || "";
      const thumb = yt ? `https://img.youtube.com/vi/${yt}/hqdefault.jpg` : "";
      const when = v.createdAt ? new Date(v.createdAt).toLocaleString() : "";

      el.innerHTML = `
        <div style="display:flex; gap:12px; align-items:flex-start;">
          ${thumb ? `<img src="${thumb}" alt="" style="width:140px; height:78px; object-fit:cover; border-radius:12px; border:1px solid rgba(255,255,255,.10);" />` : ""}
          <div>
            <h3>${v.title || "Untitled video"}</h3>
            <div class="muted">${v.desc || ""}</div>
            <div class="row" style="margin-top:10px;">
              <span class="pill">${v.category || "Uncategorized"}</span>
              <span class="muted">${when}</span>
            </div>
          </div>
        </div>
        <div style="display:flex; flex-direction:column; gap:8px; min-width:120px;">
          <button class="btn" data-watch="${v.id}">Watch</button>
        </div>
      `;

      listDiv.appendChild(el);
    });

    // Attach watch handlers
    listDiv.querySelectorAll("[data-watch]").forEach(btn => {
      btn.addEventListener("click", () => {
        const id = btn.getAttribute("data-watch");
        const vid = videos.find(x => x.id === id);
        if (!vid?.youtubeId) return alert("Missing YouTube ID/link.");
        openPlayer(vid);
      });
    });
  }

  function openPlayer(v) {
    const overlay = document.createElement("div");
    overlay.className = "modalOverlay";
    overlay.style.display = "flex";
    overlay.innerHTML = `
      <div class="modal" style="width:min(900px, 100%);">
        <div class="modalHeader">
          <h2>${v.title || "Watch"}</h2>
          <div class="close">âœ•</div>
        </div>
        <div style="margin-top:12px;">
          <div style="position:relative; padding-top:56.25%; border-radius:16px; overflow:hidden; border:1px solid rgba(255,255,255,.12);">
            <iframe
              src="https://www.youtube.com/embed/${v.youtubeId}"
              title="YouTube video player"
              style="position:absolute; inset:0; width:100%; height:100%; border:0;"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
            ></iframe>
          </div>
          <div class="muted" style="margin-top:10px;">${v.desc || ""}</div>
        </div>
      </div>
    `;
    document.body.appendChild(overlay);
    overlay.querySelector(".close").onclick = () => overlay.remove();
    overlay.onclick = (e) => { if (e.target === overlay) overlay.remove(); };
  }

  function renderAll() {
    renderCategories();
    renderList();
  }

  // =========================
  // 4) Modals
  // =========================
  function openModal(id) { document.getElementById(id).style.display = "flex"; }
  function closeModal(id) { document.getElementById(id).style.display = "none"; }

  document.querySelectorAll("[data-close]").forEach(x => {
    x.addEventListener("click", () => closeModal(x.getAttribute("data-close")));
  });

  document.getElementById("adminBtn").onclick = () => {
    document.getElementById("loginError").style.display = "none";
    document.getElementById("adminUser").value = "";
    document.getElementById("adminPass").value = "";
    openModal("loginOverlay");
  };

  document.getElementById("loginSubmit").onclick = () => {
    const u = document.getElementById("adminUser").value.trim();
    const p = document.getElementById("adminPass").value.trim();
    const ok = (u === ADMIN_USERNAME && p === ADMIN_PASSWORD);

    if (!ok) {
      document.getElementById("loginError").style.display = "block";
      return;
    }
    closeModal("loginOverlay");
    document.getElementById("addError").style.display = "none";
    document.getElementById("vLink").value = "";
    document.getElementById("vCategory").value = "";
    document.getElementById("vDesc").value = "";
    document.getElementById("vTitle").value = "";
    openModal("addOverlay");
  };

  document.getElementById("addSubmit").onclick = () => {
    const link = document.getElementById("vLink").value.trim();
    const category = document.getElementById("vCategory").value.trim();
    const desc = document.getElementById("vDesc").value.trim();
    const title = document.getElementById("vTitle").value.trim();

    if (!link || !category) {
      document.getElementById("addError").style.display = "block";
      return;
    }

    const youtubeId = extractYouTubeId(link);
    if (!youtubeId) {
      document.getElementById("addError").style.display = "block";
      document.getElementById("addError").textContent = "Could not detect YouTube video id from that link.";
      return;
    }

    const newVideo = {
      id: (crypto.randomUUID ? crypto.randomUUID() : String(Date.now())),
      title: title || `Video â€¢ ${category}`,
      youtubeId,
      category,
      desc,
      createdAt: new Date().toISOString()
    };

    videos.push(newVideo);

    // persist ONLY the non-starter ones (simple approach: store everything except STARTER_VIDEOS length)
    // If you don't use STARTER_VIDEOS, this stores all.
    const localOnly = videos.slice(STARTER_VIDEOS.length);
    saveLocalVideos(localOnly);

    closeModal("addOverlay");
    activeCategory = category; // jump to category you added
    renderAll();
  };

  // =========================
  // 5) Controls
  // =========================
  document.getElementById("searchInput").addEventListener("input", renderList);
  document.getElementById("sortSelect").addEventListener("change", renderList);

  document.getElementById("clearCategoryBtn").onclick = () => { activeCategory = "All"; renderAll(); };

  document.getElementById("resetLocalBtn").onclick = () => {
    if (confirm("Delete videos saved in this browser? (Does not affect YouTube.)")) {
      localStorage.removeItem(STORAGE_KEY);
      videos = [...STARTER_VIDEOS];
      activeCategory = "All";
      renderAll();
    }
  };

  // Close modals by clicking outside
  ["loginOverlay","addOverlay"].forEach(id => {
    const o = document.getElementById(id);
    o.addEventListener("click", (e) => { if (e.target === o) closeModal(id); });
  });

  // First render
  renderAll();
</script>
</body>
</html>